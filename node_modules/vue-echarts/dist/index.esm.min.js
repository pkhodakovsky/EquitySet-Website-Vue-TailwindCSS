import{watch as e,inject as t,computed as n,unref as r,watchEffect as o,Vue2 as i,defineComponent as a,shallowRef as u,toRefs as c,onMounted as s,onUnmounted as l,h as p,nextTick as f}from"vue-demi";import{throttle as v,init as d}from"echarts/core";import{addListener as g,removeListener as h}from"resize-detector";var O=function(){return O=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},O.apply(this,arguments)},m=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function b(e){return t=Object.create(null),m.forEach((function(n){t[n]=function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[t].apply(e.value,n)}}(n)})),t;var t}var y={autoresize:Boolean},x="ecLoadingOptions";var j={loading:Boolean,loadingOptions:Object},_=[],E=[];!function(e,t){if(e&&"undefined"!=typeof document){var n,r=!0===t.prepend?"prepend":"append",o=!0===t.singleTag,i="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(o){var a=_.indexOf(i);-1===a&&(a=_.push(i)-1,E[a]={}),n=E[a]&&E[a][r]?E[a][r]:E[a][r]=u()}else n=u();65279===e.charCodeAt(0)&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function u(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var n=Object.keys(t.attributes),o=0;o<n.length;o++)e.setAttribute(n[o],t.attributes[n[o]]);var a="prepend"===r?"afterbegin":"beforeend";return i.insertAdjacentElement(a,e),e}}("x-vue-echarts{display:block;width:100%;height:100%}",{});var A=/^on[^a-z]/,z=function(e){return A.test(e)};i&&i.config.ignoredElements.push("x-vue-echarts");var L="ecTheme",w="ecInitOptions",T="ecUpdateOptions",U=a({name:"echarts",props:O(O({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},y),j),inheritAttrs:!1,setup:function(i,a){var p=a.attrs,m=a.listeners,y=u(),x=u(),j=u(),_=t("ecTheme",null),E=t("ecInitOptions",null),A=t("ecUpdateOptions",null),L=c(i),w=L.autoresize,T=L.manualUpdate,U=L.loading,C=L.loadingOptions,D=n((function(){return j.value||i.option||null})),S=n((function(){return i.theme||r(_)||{}})),k=n((function(){return i.initOptions||r(E)||{}})),B=n((function(){return i.updateOptions||r(A)||{}})),P=n((function(){return function(e){var t={};for(var n in e)z(n)||(t[n]=e[n]);return t}(p)}));function I(e){if(y.value){var t=x.value=d(y.value,S.value,k.value);i.group&&(t.group=i.group);var n=m;n||(n={},Object.keys(p).filter((function(e){return 0===e.indexOf("on")&&e.length>2})).forEach((function(e){var t=e.charAt(2).toLowerCase()+e.slice(3);"Once"===t.substring(t.length-4)&&(t="~".concat(t.substring(0,t.length-4))),n[t]=p[e]}))),Object.keys(n).forEach((function(e){var r=n[e];if(r){var o=e.toLowerCase();"~"===o.charAt(0)&&(o=o.substring(1),r.__once__=!0);var i=t;if(0===o.indexOf("zr:")&&(i=t.getZr(),o=o.substring(3)),r.__once__){delete r.__once__;var a=r;r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a.apply(void 0,e),i.off(o,r)}}i.on(o,r)}})),w.value?f((function(){t&&!t.isDisposed()&&t.resize(),r()})):r()}function r(){var n=e||D.value;n&&t.setOption(n,B.value)}}function N(){x.value&&(x.value.dispose(),x.value=void 0)}var R=null;e(T,(function(t){"function"==typeof R&&(R(),R=null),t||(R=e((function(){return i.option}),(function(e,t){e&&(x.value?x.value.setOption(e,O({notMerge:e.value!==(null==t?void 0:t.value)},B.value)):I())}),{deep:!0}))}),{immediate:!0}),e([S,k],(function(){N(),I()}),{deep:!0}),o((function(){i.group&&x.value&&(x.value.group=i.group)}));var q=b(x);return function(e,i,a){var u=t("ecLoadingOptions",{}),c=n((function(){return O(O({},r(u)),null==a?void 0:a.value)}));o((function(){var t=e.value;t&&(i.value?t.showLoading(c.value):t.hideLoading())}))}(x,U,C),function(t,n,r){var o=null;e([r,t,n],(function(e,t,n){var r=e[0],i=e[1],a=e[2];r&&i&&a&&(o=v((function(){i.resize()}),100),g(r,o)),n((function(){o&&r&&h(r,o)}))}))}(x,w,y),s((function(){I()})),l(N),O({chart:x,root:y,setOption:function(e,t){i.manualUpdate&&(j.value=e),x.value?x.value.setOption(e,t||{}):I(e)},nonEventAttrs:P},q)},render:function(){var e=O({},this.nonEventAttrs);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",p("x-vue-echarts",e)}});export{w as INIT_OPTIONS_KEY,x as LOADING_OPTIONS_KEY,L as THEME_KEY,T as UPDATE_OPTIONS_KEY,U as default};
//# sourceMappingURL=index.esm.min.js.map
